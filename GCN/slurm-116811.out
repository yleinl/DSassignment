Hello, I am  2
Hello, I am  1
Hello, I am  0
data sent to node 1
data received on node 1 from node 0
owned_nodes tensor([   0,    1,    2,  ..., 1351, 1352, 1353])
communication_nodes [1359 1361 1362 1363 1366 1367 1373 1382 1388 1389 1393 1400 1402 1412
 1414 1415 1417 1427 1433 1434 1435 1439 1449 1461 1464 1465 1473 1480
 1484 1485 1495 1499 1504 1506 1511 1513 1518 1526 1546 1550 1552 1555
 1558 1559 1561 1567 1573 1583 1584 1588 1589 1594 1596 1606 1614 1615
 1619 1620 1624 1629 1632 1637 1647 1649 1661 1673 1688 1699 1715 1717
 1723 1746 1747 1754 1755 1769 1770 1781 1789 1790 1795 1797 1806 1809
 1811 1814 1819 1826 1830 1831 1832 1836 1838 1845 1847 1853 1855 1861
 1867 1872 1881 1897 1899 1900 1906 1909 1911 1913 1915 1918 1926 1927
 1934 1940 1949 1950 1966 1969 1972 1975 1989 1994 1995 1996 2001 2010
 2025 2026 2029 2045 2048 2052 2053 2054 2060 2061 2062 2063 2064 2065
 2066 2067 2072 2073 2074 2077 2079 2089 2098 2100 2102 2103 2104 2105
 2106 2107 2108 2112 2118 2120 2122 2123 2124 2125 2126 2132 2133 2140
 2146 2147 2153 2154 2155 2157 2165 2166 2167 2168 2169 2170 2171 2172
 2173 2180 2183 2185 2186 2187 2188 2194 2196 2199 2208 2209 2213 2220
 2227 2230 2231 2238 2241 2245 2246 2247 2248 2250 2251 2257 2261 2264
 2266 2273 2275 2280 2283 2284 2285 2287 2288 2292 2299 2318 2319 2323
 2326 2330 2331 2337 2342 2344 2357 2358 2384 2399 2400 2404 2430 2440
 2454 2487 2523 2524 2525 2526 2528 2529 2530 2532 2533 2535 2536 2537
 2538 2539 2540 2541 2542 2543 2545 2546 2547 2548 2551 2552 2553 2554
 2555 2556 2557 2559 2560 2561 2562 2563 2564 2565 2566 2567 2568 2569
 2570 2571 2572 2576 2577 2578 2579 2580 2581 2582 2583 2584 2585 2586
 2587 2588 2589 2590 2591 2592 2593 2594 2595 2596 2597 2598 2599 2600
 2601 2602 2604 2605 2606 2607 2608 2609 2610 2611 2612 2614 2615 2616
 2617 2618 2619 2620 2621 2622 2623 2624 2625 2626 2627 2628 2629 2630
 2631 2632 2633 2634 2635 2636 2637 2638 2639 2640 2641 2642 2643 2644
 2645 2646 2647 2648 2649 2650 2651 2652 2653 2654 2655 2656 2657 2658
 2659 2660 2661 2662 2663 2664 2665 2666 2667 2668 2669 2670 2672 2673
 2674 2675 2676 2677 2678 2679 2680 2681 2682 2683 2684 2686 2687 2688
 2690 2691 2693 2694 2697 2698 2699 2700 2701 2702 2703 2704 2705 2706
 2707] (407,)
data sent to node 2
data received on node 2 from node 0
owned_nodes tensor([1354, 1355, 1356,  ..., 2705, 2706, 2707])
[[], [], []]
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]]) torch.Size([1354, 1433])
tensor([[   0,    0,    0,  ..., 2523, 2523, 2523],
        [ 375, 1113, 2599,  ...,   97,  352,  857]]) torch.Size([2, 6356])
world size 3
request nodes: 0
request nodes: 0
Traceback (most recent call last):
  File "GCN_Cora_Distributed_MulNode.py", line 185, in <module>
    main(rank, world_size, host_addr_full)
  File "GCN_Cora_Distributed_MulNode.py", line 171, in main
    _, pred = model(data).max(dim=1)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "GCN_Cora_Distributed_MulNode.py", line 136, in forward
    x = self.conv1(x, edge_index)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "GCN_Cora_Distributed_MulNode.py", line 19, in forward
    return self.propagate(edge_index, size=(x.size(0), x.size(0)), x=x)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch_geometric/nn/conv/message_passing.py", line 310, in propagate
    size, kwargs)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch_geometric/nn/conv/message_passing.py", line 202, in __collect__
    j if arg[-2:] == '_j' else i)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch_geometric/nn/conv/message_passing.py", line 171, in __lift__
    return src.index_select(self.node_dim, index)
IndexError: index out of range in self
communication_nodes [   0    2    3    4    6    7    8    9   11   16   23   27   34   36
   37   39   41   44   49   51   52   55   57   58   62   64   66   69
   71   72   73   74   75   77   80   87   88   91   94   97   98  103
  105  107  112  113  114  115  118  120  122  124  129  130  135  139
  141  146  148  149  150  152  155  157  159  163  165  176  179  181
  182  183  185  188  199  200  212  215  216  218  220  221  223  224
  225  226  231  234  236  238  242  243  247  252  256  257  259  260
  262  263  266  269  270  271  272  274  276  278  280  281  282  284
  286  289  291  293  294  297  299  300  301  304  309  310  313  315
  317  318  322  324  328  329  334  335  337  341  343  344  347  350
  352  356  359  360  361  364  365  366  367  368  369  370  377  378
  389  391  393  411  416  418  420  422  424  426  427  428  429  430
  431  432  437  440  441  443  444  445  446  447  448  449  450  460
  464  466  474  477  485  489  490  491  493  496  505  509  516  518
  522  535  538  539  548  553  557  559  562  565  568  569  570  572
  574  582  584  588  589  592  593  594  599  601  602  610  611  612
  614  615  618  619  623  628  629  630  631  632  633  634  636  639
  640  648  649  651  652  653  654  660  661  665  670  672  673  674
  675  676  682  683  684  685  686  693  694  698  700  701  704  710
  714  715  718  728  729  733  739  742  746  747  756  758  759  760
  764  768  769  778  786  787  788  792  793  799  800  801  804  806
  808  809  811  812  813  819  825  828  832  834  835  836  839  840
  841  842  851  854  857  858  860  866  871  874  875  876  878  881
  883  884  887  888  889  890  893  900  903  908  911  913  920  921
  925  927  928  931  933  938  941  942  947  948  949  950  951  955
  959  961  968  972  974  976  977  980  982  984  986  990  992  996
  997  999 1001 1003 1005 1008 1009 1010 1013 1016 1017 1020 1021 1024
 1026 1029 1032 1033 1034 1036 1040 1042 1047 1048 1049 1054 1060 1069
 1072 1074 1075 1078 1083 1085 1087 1088 1089 1090 1091 1092 1093 1101
 1102 1103 1113 1116 1119 1126 1131 1135 1136 1137 1138 1139 1141 1142
 1144 1147 1158 1168 1169 1172 1174 1175 1176 1182 1183 1185 1186 1191
 1192 1193 1194 1198 1200 1201 1202 1206 1212 1216 1217 1221 1239 1242
 1244 1245 1246 1255 1261 1267 1278 1287 1288 1297 1304 1312 1315 1321
 1322 1323 1324 1325 1339 1347] (468,)
[[], [0, 2, 3, 4, 6, 7, 8, 9, 11, 16, 23, 27, 34, 36, 37, 39, 41, 44, 49, 51, 52, 55, 57, 58, 62, 64, 66, 69, 71, 72, 73, 74, 75, 77, 80, 87, 88, 91, 94, 97, 98, 103, 105, 107, 112, 113, 114, 115, 118, 120, 122, 124, 129, 130, 135, 139, 141, 146, 148, 149, 150, 152, 155, 157, 159, 163, 165, 176, 179, 181, 182, 183, 185, 188, 199, 200, 212, 215, 216, 218, 220, 221, 223, 224, 225, 226, 231, 234, 236, 238, 242, 243, 247, 252, 256, 257, 259, 260, 262, 263, 266, 269, 270, 271, 272, 274, 276, 278, 280, 281, 282, 284, 286, 289, 291, 293, 294, 297, 299, 300, 301, 304, 309, 310, 313, 315, 317, 318, 322, 324, 328, 329, 334, 335, 337, 341, 343, 344, 347, 350, 352, 356, 359, 360, 361, 364, 365, 366, 367, 368, 369, 370, 377, 378, 389, 391, 393, 411, 416, 418, 420, 422, 424, 426, 427, 428, 429, 430, 431, 432, 437, 440, 441, 443, 444, 445, 446, 447, 448, 449, 450, 460, 464, 466, 474, 477, 485, 489, 490, 491, 493, 496, 505, 509, 516, 518, 522, 535, 538, 539, 548, 553, 557, 559, 562, 565, 568, 569, 570, 572, 574, 582, 584, 588, 589, 592, 593, 594, 599, 601, 602, 610, 611, 612, 614, 615, 618, 619, 623, 628, 629, 630, 631, 632, 633, 634, 636, 639, 640, 648, 649, 651, 652, 653, 654, 660, 661, 665, 670, 672, 673, 674, 675, 676], [682, 683, 684, 685, 686, 693, 694, 698, 700, 701, 704, 710, 714, 715, 718, 728, 729, 733, 739, 742, 746, 747, 756, 758, 759, 760, 764, 768, 769, 778, 786, 787, 788, 792, 793, 799, 800, 801, 804, 806, 808, 809, 811, 812, 813, 819, 825, 828, 832, 834, 835, 836, 839, 840, 841, 842, 851, 854, 857, 858, 860, 866, 871, 874, 875, 876, 878, 881, 883, 884, 887, 888, 889, 890, 893, 900, 903, 908, 911, 913, 920, 921, 925, 927, 928, 931, 933, 938, 941, 942, 947, 948, 949, 950, 951, 955, 959, 961, 968, 972, 974, 976, 977, 980, 982, 984, 986, 990, 992, 996, 997, 999, 1001, 1003, 1005, 1008, 1009, 1010, 1013, 1016, 1017, 1020, 1021, 1024, 1026, 1029, 1032, 1033, 1034, 1036, 1040, 1042, 1047, 1048, 1049, 1054, 1060, 1069, 1072, 1074, 1075, 1078, 1083, 1085, 1087, 1088, 1089, 1090, 1091, 1092, 1093, 1101, 1102, 1103, 1113, 1116, 1119, 1126, 1131, 1135, 1136, 1137, 1138, 1139, 1141, 1142, 1144, 1147, 1158, 1168, 1169, 1172, 1174, 1175, 1176, 1182, 1183, 1185, 1186, 1191, 1192, 1193, 1194, 1198, 1200, 1201, 1202, 1206, 1212, 1216, 1217, 1221, 1239, 1242, 1244, 1245, 1246, 1255, 1261, 1267, 1278, 1287, 1288, 1297, 1304, 1312, 1315, 1321, 1322, 1323, 1324, 1325, 1339, 1347]]
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 1.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]]) torch.Size([1354, 1433])
tensor([[   0,    2,    2,  ..., 2523, 2523, 2523],
        [2599, 1485, 2045,  ...,  352,  857, 2524]]) torch.Size([2, 5652])
world size 3
request nodes: 254
Traceback (most recent call last):
  File "GCN_Cora_Distributed_MulNode.py", line 185, in <module>
    main(rank, world_size, host_addr_full)
  File "GCN_Cora_Distributed_MulNode.py", line 171, in main
    _, pred = model(data).max(dim=1)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "GCN_Cora_Distributed_MulNode.py", line 116, in forward
    requested_nodes_list = recv_object(src = 1)
  File "/home/dsys2352/DSassignment/GCN/utils.py", line 284, in recv_object
    dist.recv(size, src=src)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch/distributed/distributed_c10d.py", line 850, in recv
    pg.recv([tensor], src, tag).wait()
RuntimeError: [/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:575] Connection closed by peer [10.141.0.2]:19373
Killing subprocess 1095821
Traceback (most recent call last):
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch/distributed/launch.py", line 340, in <module>
    main()
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch/distributed/launch.py", line 326, in main
    sigkill_handler(signal.SIGTERM, None)  # not coming back
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch/distributed/launch.py", line 301, in sigkill_handler
    raise subprocess.CalledProcessError(returncode=last_return_code, cmd=cmd)
subprocess.CalledProcessError: Command '['/home/dsys2352/miniconda3/envs/dist_GNN/bin/python', '-u', 'GCN_Cora_Distributed_MulNode.py']' returned non-zero exit status 1.
srun: error: node002: task 1: Exited with exit code 1
Traceback (most recent call last):
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch/distributed/launch.py", line 340, in <module>
    main()
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch/distributed/launch.py", line 326, in main
    sigkill_handler(signal.SIGTERM, None)  # not coming back
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch/distributed/launch.py", line 301, in sigkill_handler
    raise subprocess.CalledProcessError(returncode=last_return_code, cmd=cmd)
subprocess.CalledProcessError: Command '['/home/dsys2352/miniconda3/envs/dist_GNN/bin/python', '-u', 'GCN_Cora_Distributed_MulNode.py']' returned non-zero exit status 1.
Killing subprocess 290255
srun: error: node024: task 2: Exited with exit code 1
