Hello, I am  1
Hello, I am  2
Hello, I am  0
data sent to node 1
data received on node 1 from node 0
owned_nodes tensor([   0,    1,    2,  ..., 1351, 1352, 1353])
communication_nodes [1355 1362 1364 1367 1377 1379 1383 1386 1388 1390 1391 1395 1396 1399
 1414 1424 1425 1428 1429 1439 1444 1456 1466 1470 1480 1484 1489 1496
 1511 1514 1516 1532 1533 1539 1541 1542 1543 1548 1555 1561 1568 1569
 1570 1574 1576 1578 1594 1595 1598 1600 1601 1625 1628 1629 1640 1642
 1646 1652 1653 1658 1665 1667 1669 1670 1674 1675 1686 1687 1690 1691
 1697 1701 1713 1718 1720 1722 1723 1724 1727 1732 1735 1738 1743 1746
 1764 1776 1783 1787 1799 1804 1823 1824 1825 1828 1836 1839 1843 1845
 1846 1850 1852 1854 1864 1865 1868 1869 1871 1891 1892 1897 1911 1918
 1920 1931 1932 1942 1947 1949 1950 1953 1957 1961 1964 1967 1972 1988
 1991 1993 1994 1996 2002 2008 2012 2017 2024 2028 2029 2044 2049 2059
 2063 2065 2079 2082 2085 2092 2093 2095 2096 2099 2100 2101 2102 2103
 2104 2105 2115 2126 2137 2139 2150 2151 2152 2153 2157 2168 2169 2171
 2173 2178 2179 2180 2183 2195 2196 2201 2202 2203 2204 2205 2206 2207
 2208 2209 2210 2211 2212 2213 2218 2219 2222 2241 2264 2265 2268 2273
 2278 2286 2292 2296 2299 2301 2308 2324 2337 2338 2350 2352 2358 2359
 2364 2378 2381 2385 2386 2387 2417 2418 2430 2437 2479 2494 2537 2538
 2539 2540 2541 2542 2543 2544 2545 2547 2548 2549 2550 2551 2553 2554
 2555 2556 2557 2558 2559 2560 2561 2563 2564 2565 2566 2567 2570 2571
 2572 2573 2574 2576 2577 2578 2579 2580 2581 2582 2583 2584 2585 2586
 2587 2588 2589 2592 2595 2596 2597 2598 2599 2600 2601 2602 2603 2604
 2605 2606 2607 2608 2609 2610 2611 2612 2613 2614 2615 2616 2617 2618
 2620 2621 2622 2623 2624 2625 2627 2628 2629 2630 2631 2632 2633 2634
 2635 2636 2637 2638 2639 2640 2641 2642 2643 2644 2645 2646 2647 2648
 2649 2650 2651 2652 2653 2654 2655 2656 2657 2658 2659 2660 2661 2662
 2663 2664 2665 2666 2667 2668 2669 2670 2671 2672 2673 2674 2675 2677
 2678 2679 2680 2681 2682 2683 2684 2685 2687 2688 2689 2690 2691 2692
 2693 2694 2695 2696 2697 2698 2701 2702 2704 2706 2707] (375,)
data sent to node 2
data received on node 2 from node 0
owned_nodes tensor([1354, 1355, 1356,  ..., 2705, 2706, 2707])
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]]) torch.Size([1354, 1433])
tensor([[   0,    0,    0,  ..., 2537, 2537, 2537],
        [ 363, 1064, 2615,  ...,   88,  341,  821]]) torch.Size([2, 6198])
world size 3
0
0
Traceback (most recent call last):
  File "GCN_Cora_Distributed_MulNode.py", line 176, in <module>
    main(rank, world_size, host_addr_full)
  File "GCN_Cora_Distributed_MulNode.py", line 162, in main
    _, pred = model(data).max(dim=1)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "GCN_Cora_Distributed_MulNode.py", line 127, in forward
    x = self.conv1(x, edge_index)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "GCN_Cora_Distributed_MulNode.py", line 19, in forward
    return self.propagate(edge_index, size=(x.size(0), x.size(0)), x=x)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch_geometric/nn/conv/message_passing.py", line 310, in propagate
    size, kwargs)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch_geometric/nn/conv/message_passing.py", line 202, in __collect__
    j if arg[-2:] == '_j' else i)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch_geometric/nn/conv/message_passing.py", line 171, in __lift__
    return src.index_select(self.node_dim, index)
IndexError: index out of range in self
communication_nodes [   0    1    2    4    7    8   15   20   21   22   26   28   33   36
   39   41   42   51   53   55   57   61   62   65   68   73   77   78
   80   81   88   89   96   97  102  104  106  107  108  109  111  112
  115  117  118  121  123  124  126  133  139  140  141  142  143  145
  155  158  160  165  168  171  174  177  181  186  190  194  196  197
  201  204  205  208  209  210  212  213  215  217  221  223  225  229
  232  234  237  241  243  245  249  250  254  255  256  257  259  261
  263  264  267  270  275  277  279  281  285  286  290  302  308  310
  317  319  321  322  323  327  328  330  332  333  335  336  337  338
  339  341  344  347  349  350  351  357  358  367  368  369  373  379
  380  393  395  396  398  399  403  405  406  407  408  409  415  416
  418  420  421  422  441  442  460  462  463  466  476  480  482  484
  487  492  499  515  523  528  529  532  534  536  538  539  544  554
  560  564  567  568  570  572  574  580  581  582  583  586  589  590
  598  600  601  602  607  608  617  618  624  628  629  636  637  644
  645  647  657  660  662  664  665  666  667  674  676  680  682  684
  686  691  692  693  696  697  701  708  710  711  719  721  726  731
  744  746  749  753  754  759  761  765  766  767  768  771  773  774
  780  782  784  786  788  795  798  802  804  808  809  816  818  821
  822  823  832  838  839  843  849  853  854  856  857  858  859  860
  869  878  880  881  884  886  889  891  892  895  897  901  903  904
  922  923  932  933  934  938  941  945  948  949  953  955  957  960
  962  965  967  970  971  972  975  979  980  982  987  988  991  992
  993  995  999 1001 1006 1007 1008 1009 1013 1015 1016 1017 1019 1022
 1024 1036 1043 1048 1051 1054 1055 1064 1067 1072 1077 1078 1079 1080
 1084 1087 1090 1093 1094 1095 1096 1098 1101 1102 1103 1112 1122 1123
 1124 1126 1135 1137 1138 1139 1151 1159 1166 1168 1169 1170 1175 1177
 1179 1183 1184 1185 1187 1188 1189 1192 1202 1203 1204 1208 1209 1218
 1219 1220 1224 1243 1247 1253 1257 1259 1260 1266 1267 1269 1270 1272
 1277 1278 1280 1281 1283 1287 1293 1295 1297 1298 1305 1308 1309 1322
 1329 1331 1332 1333 1334 1335 1336 1337 1343 1345 1349 1350] (432,)
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]]) torch.Size([1354, 1433])
tensor([[   0, 1354, 1354,  ..., 2537, 2537, 2537],
        [2615, 1355, 1633,  ...,  341,  821, 2538]]) torch.Size([2, 5708])
world size 3
221
Traceback (most recent call last):
  File "GCN_Cora_Distributed_MulNode.py", line 176, in <module>
    main(rank, world_size, host_addr_full)
  File "GCN_Cora_Distributed_MulNode.py", line 162, in main
    _, pred = model(data).max(dim=1)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "GCN_Cora_Distributed_MulNode.py", line 107, in forward
    requested_nodes_list = recv_object(src = 1)
  File "/home/dsys2352/DSassignment/GCN/utils.py", line 284, in recv_object
    dist.recv(size, src=src)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch/distributed/distributed_c10d.py", line 850, in recv
    pg.recv([tensor], src, tag).wait()
RuntimeError: [/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:575] Connection closed by peer [10.141.0.2]:33204
Traceback (most recent call last):
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch/distributed/launch.py", line 340, in <module>
    main()
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch/distributed/launch.py", line 326, in main
    sigkill_handler(signal.SIGTERM, None)  # not coming back
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch/distributed/launch.py", line 301, in sigkill_handler
    raise subprocess.CalledProcessError(returncode=last_return_code, cmd=cmd)
subprocess.CalledProcessError: Command '['/home/dsys2352/miniconda3/envs/dist_GNN/bin/python', '-u', 'GCN_Cora_Distributed_MulNode.py']' returned non-zero exit status 1.
Killing subprocess 1094133
srun: error: node002: task 1: Exited with exit code 1
Traceback (most recent call last):
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch/distributed/launch.py", line 340, in <module>
    main()
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch/distributed/launch.py", line 326, in main
    sigkill_handler(signal.SIGTERM, None)  # not coming back
  File "/home/dsys2352/miniconda3/envs/dist_GNN/lib/python3.6/site-packages/torch/distributed/launch.py", line 301, in sigkill_handler
    raise subprocess.CalledProcessError(returncode=last_return_code, cmd=cmd)
subprocess.CalledProcessError: Command '['/home/dsys2352/miniconda3/envs/dist_GNN/bin/python', '-u', 'GCN_Cora_Distributed_MulNode.py']' returned non-zero exit status 1.
Killing subprocess 288637
srun: error: node024: task 2: Exited with exit code 1
